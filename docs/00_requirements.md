# 要求定義（MVP）v0.3 — 2025-12-24

## 目的
個人運用（自分専用）のデスクトップアプリとして、以下を一体化して「仕入れ判断 → 配送設計 → 利益見込み」を最短で出せるようにする。

- 最安仕入れ候補の収集（楽天 / Yahoo / Amazon PA-API / 価格.com最安(暫定: Tavily)）
- 最安判定：**価格+送料**のみ（ポイント・クーポン等は扱わない）
- 配送最安推定（メルカリ便前提、料金表は手入力）
- 利益計算（売価、手数料率、送料、資材、原価）
- 相場情報の保存（手入力のみ）
- 取得頻度：手動更新のみ（定期実行なし）

## 対応環境
- Windows / macOS
- Python 実行運用（venv/uv/poetry）
- ローカルDB：SQLite

## MVP 機能一覧
1. 商品マスター（CRUD）
2. 仕入れ候補取得（手動）
   - 楽天（公式API）
   - Yahoo!ショッピング（公式API）
   - Amazon（PA-API）
   - 価格.com最安：Tavily Search/Extract で“候補として抽出”、**必ず目視確認可能**
3. Offer一覧と最安ランキング（total=price+shipping）
4. 配送最安推定（shipping_rules を手入力管理）
5. 利益計算（粗利/利益率/損益分岐/目標利益ライン）
6. 相場レンジ保存（low/mid/high + メモ）
7. 履歴（offers/calculations）
8. CSV入出力（items/offers/calculations/market_refs）
9. 設定画面（APIキー入力→ローカル保存）
10. ログ（INFO/WARN/ERROR、通信失敗でも落ちない）
11. GUIはモダンなデザイン

## 明確に除外（当面やらない）
- メルカリ内部データのスクレイピング/自動収集
- 相場のOCR取り込み（将来拡張）
- 定期更新（スケジューラ）
- ポイント/クーポン/会員価格込みの厳密最安判定

## 受け入れ基準（MVP Done）
- Windows/macOSで起動し、SQLiteに読み書きできる
- 商品登録できる
- 「候補更新」で楽天/Yahoo/AmazonのいずれかからOfferを取得→保存→表示できる
- 価格.com最安は Tavily 経由で候補として保存・表示でき、raw_text/信頼度が見える
- 送料表に基づく配送最安推定が動く
- 利益計算（粗利・分岐点・目標ライン）が出る
- CSVエクスポートできる
- 通信失敗でもクラッシュしない（部分成功OK）
